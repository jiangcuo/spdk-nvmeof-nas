# SPDK NAS Manager

SPDK NAS Manager æ˜¯ä¸€ä¸ªç»¼åˆçš„å­˜å‚¨ç®¡ç†å¹³å°ï¼Œç”± RESTful API åç«¯å’Œç°ä»£åŒ– Web å‰ç«¯ç»„æˆï¼Œç”¨äºç®¡ç† SPDK (Storage Performance Development Kit) ç»„ä»¶ï¼ŒåŒ…æ‹¬ NVMe-oF å­ç³»ç»Ÿã€RAID é˜µåˆ—ã€å—è®¾å¤‡å’Œå­˜å‚¨å·ç®¡ç†ã€‚

é€‚é…æœ€æ–°çš„spdk25.04 ç‰ˆæœ¬

## ğŸ—ï¸ æ¶æ„

æœ¬ç¨‹åºå°†spdk_tgt rpc é€šè¿‡socketè½¬æˆäº†restfulï¼Œé»˜è®¤ä½¿ç”¨`/var/tmp/spdk_tgt.sock`ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªå‰ç«¯è¿›è¡Œç®¡ç†ã€‚

ä½ éœ€è¦é…ç½®å¥½spdk_tgtçš„è¿è¡Œç¯å¢ƒã€‚å¯ä»¥é…åˆpxvirt-spdkè¿›è¡Œä½¿ç”¨ã€‚ä¹Ÿå¯ä»¥ç›´æ¥ç¼–è¯‘å¥½spdkï¼Œç„¶åæ‰§è¡Œã€‚

```
spdk_tgt -m 0x2 -s 2048 -r /var/tmp/spdk_tgt.sock &
```

éšåä½ å°±å¯ä»¥è®¿é—®web http://ip:3000ã€‚é»˜è®¤è´¦å·ä¸ºadmin å¯†ç ä¸ºadmin123

![](/img/index.png)


## å®‰è£…

### å®‰è£…nodejs npm
å®‰è£…node20ï¼Œæ¨èä½¿ç”¨nvmå®‰è£…
```
nvm install 20
nvm use 20
```

### ç¼–è¯‘å‰ç«¯

```
cd webapp
npm install
npm run build
```

### è¿è¡Œä¸»ç¨‹åº
```
npm install 
npm run start
```



## ç”¨æ³•

### åˆ›å»ºbdev

è¦ä½¿ç”¨spdkï¼Œä½ éœ€è¦åˆ›å»ºbdevè®¾å¤‡ï¼Œç›®å‰ç½‘é¡µä¸Šå¯ä»¥é€šè¿‡aioå’Œç”¨æˆ·æ€nvmeåˆ›å»ºbdevã€‚

### åˆ›å»ºraid

å¦‚æœæƒ³ä¿è¯æ•°æ®å®‰å…¨ï¼Œå¯ä»¥åˆ›å»ºbdevåï¼Œå°†å¤šä¸ªbdevåŠ å…¥raidã€‚raidä¹Ÿå¯ä»¥åšä¸ºbdevã€‚

### åˆ›å»ºlvstore

lvstore å°±åƒvgä¸€æ ·ï¼Œå¯ä»¥æŠŠä¸€ä¸ªæˆ–è€…å¤šä¸ªbdevè½¬æˆå·ç»„ï¼Œç„¶ååœ¨ä¸‹é¢åˆ›å»ºlvã€‚

### Mvmeof

éœ€è¦åˆ›å»ºä¸€ä¸ªNQN ä¹‹åï¼Œåˆ›å»ºç›‘å¬å™¨å’Œå‘½åç©ºé—´ã€‚å‘½åç©ºé—´é€‰æ‹©bdevï¼Œå°±æ˜¯nvmeofçš„å¯¹è±¡

## æœªå®Œæˆé¡¹

ç›®å‰ç¨‹åºåªå®Œæˆäº†SPDK é…ç½®çš„ä¿å­˜ã€‚æ²¡æœ‰å®ç°spdk é…ç½®çš„åŠ è½½ã€‚å¦‚æœspdkç¨‹åºé‡å¯äº†ï¼Œé‚£ä¹ˆä½ å°±è¦æŠŠé…ç½®ç»™å¯¼å…¥

```
spdk_rpc  -s /var/tmp/spdk_tgt.sock < /etc/spdk/spdk_tgt.conf
```

